

# Security Automation Scanner

A comprehensive security scanning tool that automates various security assessment tasks for a given domain. This tool performs multiple security checks including vulnerability scanning, infrastructure analysis, DNS analysis, email security checks, and more.

## Features

- Vulnerability Scanning (Nikto, Nuclei, WPScan)
- Infrastructure Analysis (RustScan, Nmap)
- DNS Analysis and Subdomain Enumeration (SecurityTrails, crt.sh, VirusTotal)
- Email Security Configuration Check (MxToolbox)
- TLS/SSL Security Analysis  (SSLabls)
- Technology Stack Detection (WhatWeb)
- Dark Web Exposure Check (only via Amfhia)
- Leadked Credential Discovery (Dehashed)
- Google Dorking for Sensitive Information (Google... duh)
- Saves screenshots of each subdomain (PlayWright)
- Qualys Integration for Additional Scanning

## Limitations
- Needs further integration with tools such as Harvester to scrape employee and account information
- Doesn't automatically crack hashes which are found
- Can only scan one top-level domain at a time
- **Requires paid accounts** to third-party tools (Dehashed). Please not that this requires a paid subscription to Dehashed AND api credits.
- **Takes a LONG TIME to run**. Nikto is by far the longest part, it is hard-coded to timeout after 10 minutes.
- Output only in JSON
- **Google Dorking is currently broken**, need to figure out how to evade Google's captchas
- Currently there is no option to run only parts of the scan, it runs the entirety of the scan or none at all
- Dark web scan is pretty shit, ideally would integrate with IntelX or similar, but they charge 2500 Euros a year for API access.
- **I have NOT tested the WPScan integration at all**, as I don't have a wordpress website to test it on at the moment.

Please create a GitHub issue for any feature requests or bugs. Otherwise fix it yourself and make a pulll request.

## Prerequisites

- Python 3.8 or higher
- Git
- System-level dependencies (will attempt to be installed automatically on first run):
  - RustScan
  - Nmap
  - Nikto
  - Nuclei
  - WPScan
  - WhatWeb

## Installation

1. Clone the repository:
```bash
git clone https://github.com/yourusername/SecurityAutomationScript.git
cd SecurityAutomationScript
```

2. Install Python dependencies:
```bash
pip install -r requirements.txt
```
*Please let me know if I've missed any requirements, the requirements.txt file was generated by AI*

3. Configure API keys:
Create a `security_scanner/config.ini` file with your API keys:
```ini
[API_KEYS]
VIRUSTOTAL = your_virustotal_key
SECURITYTRAILS = your_securitytrails_key
DEHASHED = your_dehashed_key
DEHASHED_EMAIL = your_email
INTELX = your_intelx_key
MXTOOLBOX = your_mxtoolbox_key
HASHES = your_hashes_key
QUALYS_USERNAME = your_qualys_username
QUALYS_PASSWORD = your_qualys_password

[SETTINGS]
THREADS = 5
TIMEOUT = 300
MAX_RETRIES = 3
```

## Usage

### Basic Usage

Run a security scan on a domain:
```bash
python run.py example.com
```

### Command Line Arguments

- `domain`: The target domain to scan (required)
- `-c, --company`: Company name (optional, defaults to domain name)
- `-v, --verbose`: Enable verbose output

Example with all options:
```bash
python run.py example.com -c "Example Corp" -v
```

### Qualys Integration

To combine Qualys scan results with the main security report:
1. Manually run a qualys scan using the web UI
2. Download the report in XML format.
3. run the following command
```bash
python combine_qualys.py path/to/qualys/report.xml path/to/security_scanner/output.json -o combined_report.json
```

## Example Output

The scanner generates a comprehensive JSON report in the `scan_results_[domain]` directory. Here's an example structure:

```json
{
  "metadata": {
    "target": "blacklight.security",
    "company": "Blacklight Security",
    "scan_date": "2024-02-20T10:30:00"
  },
  "dns_records": {
    "A": ["1.2.3.4"],
    "MX": ["mail.blacklight.security"],
    "TXT": ["v=spf1 include:_spf.google.com ~all"]
  },
  "subdomains": [
    "blacklight.security",
    "www.blacklight.security",
    "mail.blacklight.security"
  ],
  "vulnerabilities": {
    "www.blacklight.security": {
      "nikto": [...],
      "nuclei": [...],
      "wordpress": [...]
    }
  },
  "darkweb": [],
  "sensitive_info": [],
  "credentials": [],
  "technologies": {
    "www.blacklight.security": {
      "Web Server": ["nginx"],
      "JavaScript Libraries": ["jQuery"],
      "CMS": ["WordPress"]
    }
  },
  "email_security": {
    "dmarc": {
      "Records": [...],
      "Errors": [],
      "Warnings": []
    },
    "spf": {
      "Records": [...],
      "Errors": [],
      "Warnings": []
    }
  },
  "tls_config": {
    "www.blacklight.security": {
      "grade": "A+",
      "warnings": false,
      "status": "Ready"
    }
  }
}
```

## Directory Structure

```
SecurityAutomationScript/
├── security_scanner/
│   ├── config.ini
│   ├── core/
│   ├── integrations/
│   ├── modules/
│   └── utils/
├── scan_results_[domain]/
├── run.py
├── combine_qualys.py
├── requirements.txt
└── README.md
```

## Contributing
Different types of scans are separated into Modules. To create a new type of scan:
1.  Create a new module in the `security_scanner/modules` directory
2. Copy the structure of one of the current modules (probably people_finder.py is easiest)
3. Modify the file to do the scanning required
4. Make sure to modify the `__init__.py` files to export the new module
5. Make sure to add the new module in the `core/scanner.py` file for it to be executed. Should be pretty self explanatory.


## Notes

- The scanner requires various API keys to function properly. Make sure to obtain the necessary API keys from the respective services.
- Some scans may take significant time to complete, especially for large domains.
- The tool automatically installs required system dependencies when needed.
- Rate limiting and API quotas should be considered when scanning multiple domains. 